(function() {

  tinymce.PluginManager.add('wpg_language', function( editor )
  {
    editor.addButton('wpg_zalaczniki', {
      text: 'Załączniki',
      onclick: function() {
        editor.insertContent('<a href="#zalaczniki">Załączniki</a>');
      }
    });

    editor.addButton('wpg_language', {
      type: 'listbox',
      text: 'Wybierz Język',
      width: 150,
      onselect: function(e) {

        //The code is based on a code MCE Accessible Language Change

        // current selection node
        var node = tinyMCE.activeEditor.selection.getNode();
        // content of current node
        var selected_text = tinyMCE.activeEditor.selection.getContent();
        // get lang value of current node
        var node_attribute_lang = node.getAttribute('lang');

        var return_text = '';

        // set attribute lang and class=lang for current node
        var attr_language = this.value();


        if (attr_language) {
          // if span and lang attribute exists
          if (node.nodeName.toLowerCase() == 'span' && node_attribute_lang) {
            tinyMCE.activeEditor.dom.setAttribs(node, {'lang': attr_language});

          } else {
            // current selection has content
            if (selected_text) {
              return_text = '<span lang="' + attr_language + '">' + selected_text + '</span>';
              tinyMCE.activeEditor.selection.setContent(return_text);
              // if only cursor is set
            } else {
              tinyMCE.activeEditor.dom.setAttribs(node, {'lang': attr_language});
            }
          }
        }
        else {
          console.log(selected_text);
          // current selection has content
          if (selected_text) {
            tinyMCE.activeEditor.dom.remove(node);
            return_text = selected_text;
            tinyMCE.activeEditor.selection.setContent(return_text);

            // if only cursor is set
          } else {
            tinyMCE.activeEditor.dom.setAttribs(node, {'lang': '','hreflang': ''});
          }

        }

      },

      values: [
        {text: 'Usuń', value: ''},
        {text: 'abchaski', value: 'ab'},
        {text: 'afar, danakilski', value: 'aa'},
        {text: 'afrikaans, afrykanerski', value: 'af'},
        {text: 'ajmara', value: 'ay'},
        {text: 'akan', value: 'tw'},
        {text: 'albański', value: 'sq'},
        {text: 'amharski', value: 'am'},
        {text: 'angielski', value: 'en'},
        {text: 'arabski', value: 'ar'},
        {text: 'aragoński', value: 'an'},
        {text: 'asamski', value: 'as'},
        {text: 'azerski', value: 'az'},
        {text: 'baskijski', value: 'eu'},
        {text: 'baszkirski', value: 'ba'},
        {text: 'beludżi', value: 'dz'},
        {text: 'bengalski, bangla', value: 'bn'},
        {text: 'białoruski', value: 'be'},
        {text: 'bihari', value: 'bh'},
        {text: 'birmański', value: 'my'},
        {text: 'bislama', value: 'bi'},
        {text: 'bretoński', value: 'br'},
        {text: 'bułgarski', value: 'bg'},
        {text: 'chiński tradycyjny', value: 'zh'},
        {text: 'chiński uproszczony', value: 'zh'},
        {text: 'chorwacki', value: 'hr'},
        {text: 'czeski', value: 'cs'},
        {text: 'duński', value: 'da'},
        {text: 'esperanto', value: 'eo'},
        {text: 'estoński', value: 'et'},
        {text: 'farerski', value: 'fo'},
        {text: 'farsi', value: 'fa'},
        {text: 'fidżyjski', value: 'fj'},
        {text: 'fiński', value: 'fi'},
        {text: 'francuski', value: 'fr'},
        {text: 'fryzyjski', value: 'fy'},
        {text: 'gaelicki (Manx)', value: 'gv'},
        {text: 'gaelicki (szkocki)', value: 'gd'},
        {text: 'galicyjski', value: 'gl'},
        {text: 'grecki', value: 'el'},
        {text: 'grenlandzki', value: 'kl'},
        {text: 'gruziński', value: 'ka'},
        {text: 'guarani', value: 'gn'},
        {text: 'gudżarati', value: 'gu'},
        {text: 'hausa', value: 'ha'},
        {text: 'hebrajski', value: 'he'},
        {text: 'hindi', value: 'hi'},
        {text: 'hiszpański', value: 'es'},
        {text: 'holenderski', value: 'nl'},
        {text: 'ido', value: 'io'},
        {text: 'indonezyjski', value: 'in'},
        {text: 'interlingua', value: 'ia'},
        {text: 'interlingue, occidental', value: 'ie'},
        {text: 'inuktitut', value: 'iu'},
        {text: 'inupiak', value: 'ik'},
        {text: 'irlandzki', value: 'ga'},
        {text: 'islandzki', value: 'is'},
        {text: 'japoński', value: 'ja'},
        {text: 'jawajski', value: 'jv'},
        {text: 'jidysz', value: 'yi'},
        {text: 'joruba', value: 'yo'},
        {text: 'kambodżański', value: 'km'},
        {text: 'kannada', value: 'kn'},
        {text: 'kaszmirski', value: 'ks'},
        {text: 'kataloński', value: 'ca'},
        {text: 'kazachski', value: 'kk'},
        {text: 'keczua', value: 'qu'},
        {text: 'kirgiski', value: 'ky'},
        {text: 'koreański', value: 'ko'},
        {text: 'korsykański', value: 'co'},
        {text: 'kreolski haitański', value: 'ht'},
        {text: 'kurdyjski', value: 'ku'},
        {text: 'laotański', value: 'lo'},
        {text: 'limburski', value: 'li'},
        {text: 'lingala', value: 'ln'},
        {text: 'litewski', value: 'lt'},
        {text: 'łaciński', value: 'la'},
        {text: 'łotewski', value: 'lv'},
        {text: 'macedoński', value: 'mk'},
        {text: 'malajalam', value: 'ml'},
        {text: 'malajski', value: 'ms'},
        {text: 'malgaski', value: 'mg'},
        {text: 'maltański', value: 'mt'},
        {text: 'maori, maoryjski', value: 'mi'},
        {text: 'marathi', value: 'mr'},
        {text: 'mołdawski', value: 'mo'},
        {text: 'mongolski', value: 'mn'},
        {text: 'naurański', value: 'na'},
        {text: 'nepalski', value: 'ne'},
        {text: 'niemiecki', value: 'de'},
        {text: 'norweski', value: 'no'},
        {text: 'nuosu', value: 'ii'},
        {text: 'oksytoński, prowansalski', value: 'oc'},
        {text: 'orija', value: 'or'},
        {text: 'ormiański', value: 'hy'},
        {text: 'oromo, oromski', value: 'om'},
        {text: 'paszto, pusztuński', value: 'ps'},
        {text: 'pendżabski', value: 'pa'},
        {text: 'polski', value: 'pl'},
        {text: 'portugalski', value: 'pt'},
        {text: 'retoromański', value: 'rm'},
        {text: 'rosyjski', value: 'ru'},
        {text: 'ruanda rundi', value: 'rw'},
        {text: 'rumuński', value: 'ro'},
        {text: 'rundi', value: 'rn'},
        {text: 'samoański', value: 'sm'},
        {text: 'sango', value: 'sg'},
        {text: 'sanskrycki', value: 'sa'},
        {text: 'serbochorwacki', value: 'sh'},
        {text: 'serbski', value: 'sr'},
        {text: 'shona', value: 'sn'},
        {text: 'sindhi', value: 'sd'},
        {text: 'słowacki', value: 'sk'},
        {text: 'słoweński', value: 'sl'},
        {text: 'somalijski', value: 'so'},
        {text: 'sotho', value: 'st'},
        {text: 'suahili', value: 'sw'},
        {text: 'suazi, siswati', value: 'ss'},
        {text: 'sundajski', value: 'su'},
        {text: 'syngaleski', value: 'si'},
        {text: 'szwedzki', value: 'sv'},
        {text: 'tadżycki', value: 'tg'},
        {text: 'tagalski', value: 'tl'},
        {text: 'tajski', value: 'th'},
        {text: 'tamilski', value: 'ta'},
        {text: 'tatarski', value: 'tt'},
        {text: 'telugu', value: 'te'},
        {text: 'tigrinia', value: 'ti'},
        {text: 'polinezyjski', value: 'to'},
        {text: 'tsonga', value: 'ts'},
        {text: 'tswana', value: 'tn'},
        {text: 'turecki', value: 'tr'},
        {text: 'turkmeński', value: 'tk'},
        {text: 'tybetański', value: 'bo'},
        {text: 'ujgurski', value: 'ug'},
        {text: 'ukraiński', value: 'uk'},
        {text: 'urdu', value: 'ur'},
        {text: 'uzbecki', value: 'uz'},
        {text: 'volapük, volapik', value: 'vo'},
        {text: 'walijski', value: 'cy'},
        {text: 'waloński', value: 'wa'},
        {text: 'węgierski', value: 'hu'},
        {text: 'wietnamski', value: 'vi'},
        {text: 'włoski', value: 'it'},
        {text: 'wolof', value: 'wo'},
        {text: 'xhosa', value: 'xh'},
        {text: 'zulu', value: 'zu'}
      ]

    });
  });
})();
